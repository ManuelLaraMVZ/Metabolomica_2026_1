---
title: "Ejercicio_PCR2"
author: "Manuel Lara"
date: "2026-02-18"
output: html_document
---

Ejercicio R de PCR

Los chunks los obtengo con: Ctrl+Alt+I / Cmd+Opt+I

Paquetería

```{r}
#install.packages("pacman")
#pacman llama a otros paquetes, y si no están los instala

library("pacman")

p_load("vroom", # llamar bases de datos
       "dplyr", #facilita  el manejo de datos
       "ggplot2") #graficar
```

Llamar base de datos

```{r}
Datos_PCR <- 
  vroom(file="https://raw.githubusercontent.com/ManuelLaraMVZ/resultados_PCR_practica/refs/heads/main/Genes.csv")

Datos_PCR
```

Aislar gen de referencia

```{r}
Gen_ref <- Datos_PCR %>% 
  filter(Gen == "B-actina") # == Idéntico
Gen_ref
```
Gen de interés

```{r}
Gen_int <- Datos_PCR %>% 
  filter(Gen != "B-actina") # != todos excepto
Gen_int
```

Analisis

```{r}
DCT <- Gen_int %>% 
  mutate(DCTC1 = C1 - Gen_ref$C1,
         DCTC2 = C2 - Gen_ref$C2,
         DCTC3 = C3 - Gen_ref$C3,
         DCTT1 = T1 - Gen_ref$T1,
         DCTT2 = T2 - Gen_ref$T2,
         DCTT3 = T3 - Gen_ref$T3) %>%
  mutate(DosDCT_C1 = 2^-DCTC1,
         DosDCT_C2 = 2^-DCTC2,
         DosDCT_C3 = 2^-DCTC3,
         DosDCT_T1 = 2^-DCTT1,
         DosDCT_T2 = 2^-DCTT2,
         DosDCT_T3 = 2^-DCTT3) %>% 
  mutate(DosDCT_Cx_prom = (DosDCT_C1+DosDCT_C2+DosDCT_C3)/3,
         DosDCT_Tx_prom = (DosDCT_T1+DosDCT_T2+DosDCT_T3)/3) %>% 
  mutate(DosDDCT = DosDCT_Tx_prom/DosDCT_Cx_prom)

DCT
```
Selección de datos para graficar
```{r}
Datos_grafica <- DCT %>% 
  select("Gen", "DosDDCT")
Datos_grafica
```

Gráfica

```{r}

Grafica_PCR <- ggplot(Datos_grafica,
                      aes(x = Gen,
                          y = DosDDCT,
                          fill = Gen)) +   # fill por Gen para colores distintos
  geom_col() +
  labs(title = "Expresión relativa de genes",
       subtitle = "Normalización con B-actina como referencia",
       caption = "Fuente: práctica PCR") +
  theme_minimal(base_size = 14) +   # estilo minimalista
  theme(plot.background = element_rect(fill = "white", color = NA),
        panel.background = element_rect(fill = "white", color = NA)) +
  scale_fill_brewer(palette = "Set3")   # paleta con colores distintos

Grafica_PCR
```

Análisis de regresión lineal

